#How To Change Your App Icon at Build Time

##Add toos:
```
 brew install ImageMagick
 brew install ghostscript
 brew doctor
```
##Conver and Composite 

- Conver: take an image and modifies it,then save as a new
- Compositie: combine two image together,save as third

Add text to image 

```
convert AppIcon60x60@2x.png -fill white -font Times-Bold -pointsize 18 -gravity south -annotate 0 "Hello World" test.png
```
- AppIcon60x60@2x.png is the input image’s file name;
- fill white sets the text’s fill color to white;
- font Times-Bold instructs ImageMagick to use the bold variant of the Times typeface for any text;
- pointsize 18 sets the font size to 18 pixels;
- gravity south means any text generated by the command will be aligned at the bottom of the image
- annotate 0 “Hello World” tells ImageMagick to annotate the image with the text Hello World at an angle of 0 degrees;
test.png is the name of the output file,and ImageMagick will overwrite the existing file if it already exists.

Check supported Font

```
convert -list font
```
Change Size

```
convert betaRibbon.png -resize 120x120 smallBetaRibbon.png
```
Combine

```
composite smallBetaRibbon.png test.png test2.png
```

Shell

```
echo "${BUILT_PRODUCTS_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}"
echo "${SRCROOT}"
```

[many build settings’ variables](https://developer.apple.com/legacy/library/documentation/DeveloperTools/Reference/XcodeBuildSettingRef/0-Introduction/introduction.html)

Find Soure Path

```
IFS=$'\n'
echo $(find ${SRCROOT} -name "AppIcon60x60@2x.png")
```
脚本处理完后的图片添加到ipa 中

```
PATH=${PATH}:/usr/local/bin
IFS=$'\n'
 
function generateIcon () {
  BASE_IMAGE_NAME=$1
 
  TARGET_PATH="${BUILT_PRODUCTS_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/${BASE_IMAGE_NAME}"
  BASE_IMAGE_PATH=$(find ${SRCROOT} -name ${BASE_IMAGE_NAME})
 
  WIDTH=$(identify -format %w ${BASE_IMAGE_PATH})
 
  convert betaRibbon.png -resize $WIDTHx$WIDTH resizedRibbon.png
  convert ${BASE_IMAGE_PATH} -fill white -font Times-Bold -pointsize 18 -gravity south -annotate 0 "Hello World" - | composite resizedRibbon.png - ${TARGET_PATH}
}
 
generateIcon "AppIcon60x60@2x.png"
generateIcon "AppIcon60x60@3x.png"

```

获取版本号：

```
buildNumber=$(/usr/libexec/PlistBuddy -c "Print CFBundleVersion" "${PROJECT_DIR}/${INFOPLIST_FILE}")

```